<!-- (Assume you keep your existing Page 1 as in your last implementation) -->

<!-- PAGE 2: ‚ÄúScheme-wise Details‚Äù -->
<div id="page2" style="display:none;">
  <div class="glass mb-3" style="max-width:650px;margin:auto;">
    <div style="display:flex; justify-content:center; align-items:center; gap:2em;">
      <label class="form-label mb-0" style="font-size:1.12em;font-weight:700;">‡§Ø‡•ã‡§ú‡§®‡§æ:</label>
      <select id="schemeDropdown2" class="form-select form-select-sm" style="width:260px; font-size:1.12em;"></select>
    </div>
  </div>
  <div class="glass">
    <div class="kpi-row-wrap">
      <div class="kpi-kard top">
        <div class="kpi-medal">
          <svg width="48" height="48"><circle cx="24" cy="24" r="20" fill="#ffd700"/><circle cx="24" cy="24" r="18" fill="#fffbe9"/><text x="24" y="33" text-anchor="middle" font-size="24" fill="#b68c00" font-weight="bold">1</text></svg>
        </div>
        <div class="kpi-label">‡§ü‡•â‡§™ ‡•´</div>
        <ul class="kpi-taluka-list" id="kpiTopList2"></ul>
      </div>
      <div class="kpi-kard mid">
        <div class="kpi-medal">
          <svg width="48" height="48"><circle cx="24" cy="24" r="20" fill="#e5e5e5"/><circle cx="24" cy="24" r="18" fill="#f8faf9"/><text x="24" y="33" text-anchor="middle" font-size="24" fill="#757575" font-weight="bold">2</text></svg>
        </div>
        <div class="kpi-label">‡§Æ‡§ß‡•ç‡§Ø‡§Æ ‡•´</div>
        <ul class="kpi-taluka-list" id="kpiMidList2"></ul>
      </div>
      <div class="kpi-kard bot">
        <div class="kpi-medal">
          <svg width="48" height="48"><circle cx="24" cy="24" r="20" fill="#de9c68"/><circle cx="24" cy="24" r="18" fill="#eed0b3"/><text x="24" y="33" text-anchor="middle" font-size="24" fill="#a3711d" font-weight="bold">3</text></svg>
        </div>
        <div class="kpi-label">‡§§‡§≥ ‡•´</div>
        <ul class="kpi-taluka-list" id="kpiBotList2"></ul>
      </div>
    </div>
    <div class="chart-panel">
      <div class="chart-header">üèÖ ‡§Ø‡•ã‡§ú‡§®‡§æ ‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§§‡§æ‡§≤‡•Å‡§ï‡§æ ‡§∞‡§Å‡§ï‡§ø‡§Ç‡§ó</div>
      <canvas id="barChart2" class="chart-container"></canvas>
    </div>
    <div class="glass mt-4" style="padding:1em 1.4em">
      <div style="font-weight:700;font-size:1.09em;margin-bottom:1em;">‡§§‡§æ‡§≤‡•Å‡§ï‡•ç‡§Ø‡§æ‡§Ç‡§ö‡•Ä ‡§∞‡§Å‡§ï‡§ø‡§Ç‡§ó ‡§Ø‡§æ‡§¶‡•Ä</div>
      <div class="table-responsive" style="max-height:330px">
        <table class="table table-bordered table-striped table-sm text-center" id="blockDetailsTable2">
          <thead><tr><th>‡§§‡§æ‡§≤‡•Å‡§ï‡§æ</th><th>‡§∞‡§Å‡§ï</th></tr></thead>
          <tbody id="talukaRanksBody2"></tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<script>
// -------- PAGE 2 DATA + UI LOGIC
let barChart2;
function renderSchemeDropdown2() {
  document.getElementById("schemeDropdown2").innerHTML =
    schemes.map(s=>`<option>${s}</option>`).join("");
}
function getRankList2(scheme) {
  return rawData
    .map((r) => ({ b: r._block, rank: parseInt(r[scheme])||999 }))
    .sort((a, b) => a.rank-b.rank);
}
function renderPage2() {
  renderSchemeDropdown2();
  const scheme = document.getElementById("schemeDropdown2").value || schemes[0];
  const all = getRankList2(scheme);
  document.getElementById('kpiTopList2').innerHTML =
    all.slice(0,5).map(x=>`<li>${x.b} <span style="color:#818cf8">&nbsp;#${x.rank}</span></li>`).join('');
  document.getElementById('kpiMidList2').innerHTML =
    all.slice(5,10).map(x=>`<li>${x.b} <span style="color:#b45309">&nbsp;#${x.rank}</span></li>`).join('');
  document.getElementById('kpiBotList2').innerHTML =
    all.slice(10,15).map(x=>`<li>${x.b} <span style="color:#b91c1c">&nbsp;#${x.rank}</span></li>`).join('');
  barChart2?.destroy();
  const pal = ["#6366f1","#10b981","#f59e0b","#ef4444","#3b82f6","#818cf8"];
  barChart2 = new Chart(document.getElementById("barChart2").getContext("2d"), {
    type: "bar",
    data: {
      labels: all.map(x=>x.b),
      datasets: [
        { data: all.map(x => (isFinite(x.rank)&&x.rank<=15?x.rank:0)), backgroundColor: pal, borderRadius:8 }
      ]
    },
    options: { indexAxis: "y", plugins: {
      legend:{display:false},
      datalabels:{anchor:"end",align:"right",formatter:(v)=>v>0?`#${v}`:'-' }
    }, responsive:true, maintainAspectRatio:false },
    plugins: [ChartDataLabels]
  });
  document.getElementById("talukaRanksBody2").innerHTML =
    all.slice(0,15).map((x,i)=>`<tr class='${i<5?'top':i<10?'mid':'bot'}'>
    <td>${x.b}</td><td style="font-size:1.07em"><b>${isFinite(x.rank)&&x.rank<=15?x.rank:"-"}</b></td>
  </tr>`).join('');
}
document.getElementById("schemeDropdown2").addEventListener("change",renderPage2);
document.getElementById("p2btn").onclick = () => { showPage(2); renderPage2(); };
document.getElementById("p1btn").onclick = () => showPage(1);
function showPage(pg){
  document.getElementById("page1").style.display = pg===1?"":"none";
  document.getElementById("page2").style.display = pg===2?"":"none";
  if(pg===1) renderPage1();
}
</script>
