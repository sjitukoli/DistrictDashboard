<!DOCTYPE html>
<html lang="mr">
<head>
  <meta charset="UTF-8">
  <title>‡§Ø‡•ã‡§ú‡§®‡§æ ‡§°‡•Ö‡§∂‡§¨‡•ã‡§∞‡•ç‡§° ¬∑ ‡§ú‡§≥‡§ó‡§æ‡§µ ‡§ú‡§ø‡§≤‡•ç‡§π‡§æ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <!-- Bootstrap & Font -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Devanagari:wght@500;700&display=swap" rel="stylesheet"/>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>
  <style>
    body { font-family:'Noto Sans Devanagari',sans-serif;background:#f5f8ff;margin:0;padding:0.8rem;color:#23263a;}
    .glass { background: #fff; border-radius: 16px; box-shadow: 0 4px 18px #0002; margin-bottom:1.2rem; padding:1.2rem; }
    .tab-btn { font-weight:700; padding:.42em 1.3em; border-radius:2em; margin-right:8px;
      color:#222;background:#ede9fe; border:none;cursor:pointer; transition:.18s;}
    .tab-btn.active,.tab-btn:hover { background:#818cf8;color:#fff; transform:scale(1.07);}
    .kpi-list { display:flex;flex-wrap:wrap;gap:.62rem;justify-content:center;margin-bottom:.6rem;}
    .kpi-badge { background: linear-gradient(100deg,var(--kpi-c1,#a5b4fc),var(--kpi-c2,#818cf8) 70%); color:#fff;
      border-radius:38px; box-shadow:0 2px 15px #4750c930; font-weight:800;
      padding:.42em 2.2em;.letter-spacing:.02em;font-size:1.12em;display:flex;align-items:center;cursor:pointer;transition:.18s;border:3px solid transparent; min-width:168px;}
    .kpi-badge svg,.kpi-badge .badge-emo{font-size:1.7em;margin-right:.54em; filter:drop-shadow(0 0 6px #fff); }
    .kpi-badge.top { --kpi-c1:#b7f5b0; --kpi-c2:#22d36e; border-color:#15c969;}
    .kpi-badge.mid { --kpi-c1:#fbbf24; --kpi-c2:#f9d444; border-color:#facc15;}
    .kpi-badge.bot { --kpi-c1:#fca5a5; --kpi-c2:#ef4444; border-color:#ef4444;}
    .kpi-badge.selected, .kpi-badge:hover { background:linear-gradient(91deg,#fbbf24 10%,#6366f1 100%); color:#fff; border-color:#6366f1; box-shadow:0 0 0 4px #b3bcf638;}
    .chip {display:inline-block;padding:0.25em 1em;background:#e0e7ff;color:#1e40af;
      font-size:.97em;font-weight:700;border-radius:20px;margin:4px 8px;transition:.15s;cursor:pointer;}
    .chip.selected, .chip:hover { background:#facc15; color:#78350f; transform:scale(1.07);}
    .drop-margin { margin-bottom:1.1em; }
    .chart-header { text-align:center; font-size:1.07em;font-weight:700;color:#6366f1;margin-bottom:.7rem;}
    .chart-flex { display:flex; flex-wrap:wrap; gap:1.2em; }
    .chart-panel { min-width:340px; flex:1 1 380px; background:#f9fafb; border-radius:16px; padding:1.2em; box-shadow:0 2px 8px #6366f111;margin-bottom:.5em;}
    .chart-container { height:230px; }
    .suggestion-box { background:#e0f2fe; border-radius:10px; padding:1em 1.2em; font-size:1.08em; color:#0e374c; margin-top:.7em;}
    .btn-ai { background: linear-gradient(90deg,#818cf8,#fbbf24); color:#fff; font-weight:700; border:none; border-radius:30px; padding:.5em 1.3em; margin:0 6px; box-shadow:0 1px 7px #facc1577; transition:.12s; }
    .btn-ai:hover {background:linear-gradient(93deg,#fbbf24,#6366f1);}
    .kpi-badge .taluka {display:inline-block;text-shadow:0 1px 3px #0001;font-size:1.06em;}
    .scheme-result { background:#f3f6fb; border-radius:8px;padding:.8em;margin-bottom:1.1em;min-height:70px;color:#222;}
    .scheme-result .title{font-weight:bold;color:#0c3096;margin-bottom:2px;}
    .scheme-result p{margin-bottom:.4em}
    @media (max-width:1200px){.chart-flex{flex-direction:column;}}
  </style>
</head>
<body>
<div id="main">
  <!-- PAGE SWITCHING BUTTONS -->
  <div class="d-flex mb-3 justify-content-between align-items-center">
    <h2 class="mb-0">üìä ‡§§‡§æ‡§≤‡•Å‡§ï‡§æ ‡§Ø‡•ã‡§ú‡§®‡§æ ‡§°‡•Ö‡§∂‡§¨‡•ã‡§∞‡•ç‡§°</h2>
    <div>
      <button id="page1btn" class="tab-btn active">‡§Æ‡•Å‡§ñ‡•ç‡§Ø</button>
      <button id="page2btn" class="tab-btn">‡§Ø‡•ã‡§ú‡§®‡§æ ‡§§‡§™‡§∂‡•Ä‡§≤</button>
    </div>
  </div>

  <!-- PAGE 1: Main Overview -->
  <div id="page1Section">
    <div class="glass">
      <div class="row align-items-end g-2">
        <div class="col-md-6 drop-margin">
          <label class="form-label">‡§Ø‡•ã‡§ú‡§®‡§æ ‡§®‡§ø‡§µ‡§°‡§æ:</label>
          <select id="schemeDropdown" class="form-select form-select-sm"></select>
        </div>
        <div class="col-md-6">
          <label class="form-label">‡§§‡§æ‡§≤‡•Å‡§ï‡§æ ‡§®‡§ø‡§µ‡§°‡§æ:</label>
          <div id="talukaChips"></div>
        </div>
      </div>
    </div>
    <div class="glass">
      <!-- First row: SVG badges for Top 5, Mid 5, Bot 5 -->
      <div class="kpi-list" id="kpiList"></div>
      <div class="chart-flex">
        <div class="chart-panel">
          <div class="chart-header">üìä ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§™‡•ç‡§∞‡§¶‡§∞‡•ç‡§∂‡§® ‡§§‡•Å‡§≤‡§®‡§æ</div>
          <div class="chart-container"><canvas id="barChart"></canvas></div>
        </div>
        <div class="chart-panel">
          <div class="chart-header">ü•ß ‡§™‡•ç‡§∞‡§§‡§ø‡§∂‡§§ ‡§µ‡§æ‡§ü‡§™</div>
          <div class="chart-container"><canvas id="donutChart"></canvas></div>
        </div>
      </div>
      <!-- Page 1, AI suggestion for Top Talukas -->
      <div class="suggestion-box" id="aiSuggestion"></div>
    </div>
  </div>

  <!-- PAGE 2: Scheme-wise Taluka Rankings -->
  <div id="page2Section" style="display:none">
    <div class="glass drop-margin">
      <label class="form-label">‡§Ø‡•ã‡§ú‡§®‡§æ ‡§®‡§ø‡§µ‡§°‡§æ:</label>
      <select id="schemeDropdown2" class="form-select form-select-sm"></select>
      <div style="margin-top:0.7em" id="schemeBadgesRow"></div>
    </div>
    <div class="glass">
      <div class="kpi-list" id="kpiTalukaList"></div>
      <div class="chart-flex">
        <div class="chart-panel">
          <div class="chart-header">üèÖ ‡§Ø‡•ã‡§ú‡§®‡§æ ‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§§‡§æ‡§≤‡•Å‡§ï‡§æ ‡§∞‡§Å‡§ï‡§ø‡§Ç‡§ó</div>
          <div class="chart-container"><canvas id="barChart2"></canvas></div>
        </div>
        <div class="chart-panel">
          <div class="chart-header">ü•ß ‡§Ø‡•ã‡§ú‡§®‡§æ ‡§µ‡§∞‡•Ä‡§≤ ‡§§‡§æ‡§≤‡•Å‡§ï‡§æ‡§Ç‡§ö‡•Ä ‡§µ‡§ø‡§§‡§∞‡§£</div>
          <div class="chart-container"><canvas id="donutChart2"></canvas></div>
        </div>
      </div>
      <div class="scheme-result" id="aiTalukaAdvice"></div>
    </div>
  </div>
</div>
<script>
  // ====== DASHBOARD DATA LOGIC ======
  // Replace with your real spreadsheet endpoint and keys if needed
  const API='AIzaSyDhCjnUv7x5yj9cXKV52Qv8CrYwUhBIWuU',
    SHEET='1y_EVqNg-reS3xV-Kn6cmTou7u_6kuyqykNdgdzXEMkE', RANGE='Rank!B5:AJ20';
  let headers,rawData,schemes;
  let barChart,donutChart,barChart2,donutChart2;

  function colorSVG(rank) {
    // SVG medal/emoji by rank (for Top/Middle/Bottom), fallback to number if needed
    if(rank<=5)   return `<span class="badge-emo" style="font-size:1.5em">ü•á</span>`;
    if(rank>10)   return `<span class="badge-emo" style="font-size:1.5em">ü•â</span>`;
    return         `<span class="badge-emo" style="font-size:1.5em">ü•à</span>`;
  }
  function svgMedal(rank) {
    // Use Olympic style SVGs or emoji
    if(rank===1) return '<svg width="36" height="36" style="margin-right:.5em;" viewBox="0 0 32 32"><circle cx="16" cy="16" r="15" fill="#ffd700" stroke="#fc0" stroke-width="1.5"/><text x="16" y="22" font-size="18" fill="#b68c00" font-weight="bold" text-anchor="middle">1</text></svg>';
    if(rank===2) return '<svg width="36" height="36" style="margin-right:.5em;" viewBox="0 0 32 32"><circle cx="16" cy="16" r="15" fill="#e5e5e5" stroke="#aaa" stroke-width="1.5"/><text x="16" y="22" font-size="18" fill="#353535" font-weight="bold" text-anchor="middle">2</text></svg>';
    if(rank===3) return '<svg width="36" height="36" style="margin-right:.5em;" viewBox="0 0 32 32"><circle cx="16" cy="16" r="15" fill="#de9c68" stroke="#9c5c07" stroke-width="1.5"/><text x="16" y="22" font-size="18" fill="#723909" font-weight="bold" text-anchor="middle">3</text></svg>';
    return '';
  }
  async function init(){
    const vals=await fetch(
      `https://sheets.googleapis.com/v4/spreadsheets/${SHEET}/values/${encodeURIComponent(RANGE)}?key=${API}`
    ).then(r=>r.json()).then(d=>d.values);
    headers=vals[0];
    rawData=vals.slice(1).map(r=>{
      let o={};headers.forEach((h,i)=>o[h]=r[i]);o._block=r[0];return o;
    });
    schemes=headers;
    document.getElementById('schemeDropdown').innerHTML=
      schemes.map(s=>`<option>${s}</option>`).join('');
    document.getElementById('schemeDropdown2').innerHTML=
      schemes.map(s=>`<option>${s}</option>`).join('');
    renderTalukaChips();
    renderPage1();
    bindUI();
  }

  function renderTalukaChips() {
    const chips = document.getElementById('talukaChips');
    chips.innerHTML = rawData.map(r=>`<span class="chip">${r._block}</span>`).join('');
    chips.querySelectorAll('.chip').forEach(el=>{
      el.onclick=()=>el.classList.toggle('selected');
    });
  }

  // -- PAGE 1: scheme select and overall block ranking display
  function renderPage1(){
    const scheme = document.getElementById('schemeDropdown').value || schemes[0];
    // Rank all blocks by the selected scheme
    const all = rawData.map(r=>({b:r._block,rank:parseInt(r[scheme])||999})).sort((a,b)=>a.rank-b.rank);
    // Display BADGE ROWS
    const list = document.getElementById('kpiList');
    list.innerHTML=all.map((t,i)=>
      `<div class="kpi-badge ${i<5?'top':i<10?'mid':'bot'}" data-block="${t.b}">
        ${svgMedal(i+1)}
        <span class="taluka" style="font-size:1.16em">${t.b}</span>
        <span style="margin-left:.45em">#${t.rank}</span>
      </div>`
    ).join('');
    // Animated effect for tap
    list.querySelectorAll('.kpi-badge').forEach(node=>{
      node.onclick=()=>showPage2(scheme,node.dataset.block);
    });
    // -- Charts
    const pal = ["#6366f1","#10b981","#f59e0b","#ef4444","#3b82f6","#818cf8"];
    barChart?.destroy(); donutChart?.destroy();
    const lab=all.map(x=>x.b), dat=all.map(x=>x.rank);
    barChart=new Chart(document.getElementById('barChart').getContext('2d'),{
      type:'bar',data:{labels:lab,datasets:[{data:dat,backgroundColor:pal,borderRadius:7}]},
      options:{indexAxis:'y',plugins:{legend:{display:false},datalabels:{anchor:'end',align:'right',formatter:v=>`#${v}`,
      font:{weight:'bold',size:14},color:'#0c1'}},responsive:true,maintainAspectRatio:false},plugins:[ChartDataLabels]});
    donutChart=new Chart(document.getElementById('donutChart').getContext('2d'),{
      type:'doughnut',data:{labels:lab,datasets:[{data:dat,backgroundColor:pal}]},
      options:{plugins:{legend:{position:'bottom'},datalabels:{formatter:v=>`#${v}`,font:{size:13}}},responsive:true,maintainAspectRatio:false},plugins:[ChartDataLabels]});
    // -- Suggestion (AI)
    const top=all[0]; let sugg='';
    if(top.rank>2)
      sugg=`${top.b} ‡§¨‡•ç‡§≤‡•â‡§ï‡§ö‡•Ä ‡§∞‡§Å‡§ï #${top.rank} ‡§Ü‡§π‡•á. "‡§™‡•ç‡§∞‡§ó‡§§‡•Ä ‡§Ö‡§∏‡§≤‡•á‡§≤‡•á ‡§µ‡§ø‡§∑‡§Ø" ‡§Ö‡§ß‡§ø‡§ï ‡§Æ‡§ú‡§¨‡•Ç‡§§ ‡§ï‡§∞‡§£‡•ç‡§Ø‡§æ‡§∏‡§æ‡§†‡•Ä ${findWeakSchemes(top.b)} ‡§Ø‡§æ ‡§Ø‡•ã‡§ú‡§®‡§æ ‡§µ‡§∞ ‡§¨‡§≥‡§ï‡§ü ‡§ï‡§æ‡§Æ ‡§ï‡§∞‡§£‡•ç‡§Ø‡§æ‡§ö‡•Ä ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï‡§§‡§æ ‡§Ü‡§π‡•á.`;
    else
      sugg=`üëè ${top.b} ‡§∏‡§∞‡•ç‡§µ‡§æ‡§ß‡§ø‡§ï ‡§∞‡§Å‡§ï‡§µ‡§∞ ‡§Ü‡§π‡•á! ‡§Ü‡§§‡§æ ‡§§‡•Å‡§Æ‡§ö‡•ç‡§Ø‡§æ ‡§Æ‡§ß‡•ç‡§Ø ‡§Ü‡§£‡§ø ‡§§‡§≥‡§∏‡•ç‡§§‡§∞‡§æ‡§§‡•Ä‡§≤ ‡§Ø‡•ã‡§ú‡§®‡§æ (${findWeakSchemes(top.b)}) ‡§∏‡•Å‡§ß‡§æ‡§∞‡§£‡•ç‡§Ø‡§æ‡§∏‡§æ‡§†‡•Ä ‡§®‡§ø‡§Ø‡•ã‡§ú‡§® ‡§ï‡§∞‡§æ.`;
    document.getElementById('aiSuggestion').innerHTML=sugg;
  }

  // ----- PAGE 2 SCHEME-WISE BLOCKS
  function showPage2(scheme, selectedBlock) {
    document.getElementById('page1Section').style.display='none';
    document.getElementById('page2Section').style.display='';
    // Set selection in dropdown
    document.getElementById('schemeDropdown2').value=scheme;
    renderPage2(selectedBlock);
  }
  function renderPage2(selectedBlock){
    const scheme=document.getElementById('schemeDropdown2').value||schemes[0];
    // Get all block ranks for this scheme
    const all=rawData.map(r=>({b:r._block,rank:parseInt(r[scheme])||999})).sort((a,b)=>a.rank-b.rank);
    // Emoji/BADGE overlay row for 5+5+5
    const badgeRow=document.getElementById('schemeBadgesRow');
    badgeRow.innerHTML=
      '<span style="font-size:1.8em">ü•á TOP 5</span>&nbsp;&nbsp;' +
      '<span style="font-size:1.8em">ü•à ‡§Æ‡§ß‡•ç‡§Ø‡§Æ 5</span>&nbsp;&nbsp;' +
      '<span style="font-size:1.8em">ü•â ‡§§‡§≥ 5</span>';
    // KPI cards below
    const kp=document.getElementById('kpiTalukaList');
    kp.innerHTML=all.map((x,i)=>
      `<div class="kpi-badge ${i<5?'top':i<10?'mid':'bot'} ${x.b===selectedBlock?'selected':''}" data-block="${x.b}">
        ${colorSVG(i+1)}
        <span class="taluka" style="font-size:1.12em">${x.b}</span>
        <span style="margin-left:0.18em">#${x.rank}</span>
      </div>`
    ).join('');
    kp.querySelectorAll('.kpi-badge').forEach(node=>{
      node.onclick=()=>{ Array.from(kp.children).forEach(k=>k.classList.remove('selected'));
        node.classList.add('selected'); renderBlockAdvice(node.dataset.block);}
    });
    // Charts
    const pal = ["#6366f1","#10b981","#f59e0b","#ef4444","#3b82f6","#818cf8"];
    barChart2?.destroy();donutChart2?.destroy();
    barChart2=new Chart(document.getElementById('barChart2').getContext('2d'),{
      type:'bar',data:{labels:all.map(x=>x.b),datasets:[{data:all.map(x=>x.rank),backgroundColor:pal,borderRadius:8}]},
      options:{indexAxis:'y',plugins:{legend:{display:false},datalabels:{anchor:'end',align:'right',formatter:v=>`#${v}`}},responsive:true,maintainAspectRatio:false},plugins:[ChartDataLabels]});
    donutChart2=new Chart(document.getElementById('donutChart2').getContext('2d'),{
      type:'doughnut',data:{labels:all.map(x=>x.b),datasets:[{data:all.map(x=>x.rank),backgroundColor:pal}]},
      options:{plugins:{legend:{position:'bottom'},datalabels:{formatter:v=>`#${v}`}},responsive:true,maintainAspectRatio:false},plugins:[ChartDataLabels]});
    // Default: show selected block or top
    renderBlockAdvice(selectedBlock||all[0].b);
  }
  function renderBlockAdvice(block){
    // For that block, get all scheme ranks (best=1)
    const arr=schemes.map(s=>({s,rank:parseInt(rawData.find(r=>r._block===block)[s])||999})).sort((a,b)=>a.rank-b.rank);
    const top3=arr.slice(0,3), bottom3=arr.slice(-3), mid3=arr.slice(Math.max(0,Math.floor(arr.length/2)-1),Math.max(0,Math.floor(arr.length/2)+2));
    // Create "AI" style hints:
    let html = `<div class="title">ü•á ‡§™‡•ç‡§∞‡§ó‡§§‡•Ä ‡§Ö‡§∏‡§≤‡•á‡§≤‡•á ‡§µ‡§ø‡§∑‡§Ø:</div><p>${top3.map(x=>`${x.s} (‡§∞‡§Å‡§ï #${x.rank})`).join(", ")}</p>`;
    html+= `<div class="title">‚öñÔ∏è ‡§™‡•ç‡§∞‡§ó‡§§‡•Ä ‡§ï‡§∞‡§£‡•á ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï:</div><p>${mid3.map(x=>`${x.s} (‡§∞‡§Å‡§ï #${x.rank})`).join(", ")}</p>`;
    html+= `<div class="title">ü•â ‡§µ‡§ø‡§∂‡•á‡§∑ ‡§≤‡§ï‡•ç‡§∑ ‡§¶‡•á‡§£‡•ç‡§Ø‡§æ‡§ö‡•á:</div><p>${bottom3.map(x=>`${x.s} (‡§∞‡§Å‡§ï #${x.rank})`).join(", ")}</p>`;
    html+= `<div style="margin-top:1.1em;font-size:1.03em;">
        <b>AI Suggestion:</b><br/>
        ${
          bottom3.length ?
          `üîé "${bottom3.map(x=>x.s).join(', ')}" ‡§Ø‡•ã‡§ú‡§®‡§æ‡§§ ${block} ‡§¨‡•ç‡§≤‡•â‡§ï‡§®‡•á ‡§™‡•ç‡§∞‡§ó‡§§‡•Ä‡§∏‡§æ‡§†‡•Ä ‡§Ö‡§§‡•ç‡§Ø‡§Ç‡§§ ‡§≤‡§ï‡•ç‡§∑‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï ‡§ï‡§æ‡§∞‡•ç‡§Ø ‡§ï‡§∞‡§æ‡§µ‡•á. ‡§™‡•Å‡§¢‡•Ä‡§≤ ‡§µ‡§∞‡•ç‡§∑‡•Ä ‡§Ø‡§æ ‡§Ø‡•ã‡§ú‡§®‡§æ‡§Ç‡§ö‡§æ ‡§∏‡•Å‡§ß‡§æ‡§∞‡§ø‡§§ ‡§ü‡§æ‡§∞‡•ç‡§ó‡•á‡§ü ‡§†‡§∞‡§µ‡§æ, ‡§∏‡•ç‡§™‡§∞‡•ç‡§ß‡§æ‡§§‡•ç‡§Æ‡§ï ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§∂‡§æ‡§≥‡§æ, ‡§µ‡§ø‡§∂‡•á‡§∑ ‡§∏‡§Ç‡§ò‡§ü‡§®, ‡§ú‡§®‡§ú‡§æ‡§ó‡•É‡§§‡•Ä ‡§µ‡§æ‡§¢‡§µ‡§æ.` :
          `üëè ‡§â‡§§‡•ç‡§ï‡•É‡§∑‡•ç‡§ü! ‡§∏‡§∞‡•ç‡§µ ‡§Ø‡•ã‡§ú‡§®‡•á‡§§ ${block} ‡§™‡•ç‡§∞‡§ó‡§§‡•Ä ‡§ï‡§∞‡•Ä‡§§ ‡§Ü‡§π‡•á.`
        }
      </div>`;
    document.getElementById('aiTalukaAdvice').innerHTML=html;
  }
  function findWeakSchemes(block){
    // Give comma separated bottom-3 schemes for that block
    const arr=schemes.map(s=>({s,rank:parseInt(rawData.find(r=>r._block===block)[s])||999}));
    return arr.sort((a,b)=>b.rank-a.rank).slice(0,3).map(x=>x.s).join(", ");
  }
  // --- UI EVENTS ---
  function bindUI(){
    document.getElementById('page1btn').onclick=()=>{showPage(1);}
    document.getElementById('page2btn').onclick=()=>{showPage(2);}
    document.getElementById('schemeDropdown').onchange=()=>renderPage1();
    document.getElementById('schemeDropdown2').onchange=()=>renderPage2();
  }
  function showPage(pg){
    document.getElementById('page1Section').style.display = pg===1?'':'none';
    document.getElementById('page2Section').style.display = pg===2?'':'none';
    if(pg===1) renderPage1(); else renderPage2();
  }
  function downloadChart(c,f){const a=document.createElement('a');a.href=c.toBase64Image();a.download=f;a.click();}
  function downloadCSV(){
    let scheme = document.getElementById('schemeDropdown').value || schemes[0];
    let csv = '‡§§‡§æ‡§≤‡•Å‡§ï‡§æ,‡§∞‡§Å‡§ï\n'+rawData.map(r=>`${r._block},${r[scheme]}`).join('\n');
    const blob=new Blob([csv],{type:'text/csv'}),
      u=URL.createObjectURL(blob),a=document.createElement('a');
    a.href=u;a.download='taluka.csv';a.click();URL.revokeObjectURL(u);
  }
  // ------
  init();
</script>
</body>
</html>
